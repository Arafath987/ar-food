{"version":3,"sources":["../../src/server/image-optimizer.ts"],"names":["getHash","detectContentType","ImageOptimizerCache","ImageError","getMaxAge","optimizeImage","imageOptimizer","sendResponse","getImageSize","Deferred","AVIF","WEBP","PNG","JPEG","GIF","SVG","ICO","CACHE_VERSION","ANIMATABLE_TYPES","VECTOR_TYPES","BLUR_IMG_SIZE","BLUR_QUALITY","sharp","require","process","env","NEXT_SHARP_PATH","concurrency","divisor","NODE_ENV","Math","floor","max","cpus","length","e","showSharpMissingWarning","getSupportedMimeType","options","accept","mimeType","mediaType","includes","items","hash","createHash","item","update","String","digest","replace","writeToCacheDir","dir","extension","maxAge","expireAt","buffer","etag","filename","join","promises","rm","recursive","force","catch","mkdir","writeFile","every","b","i","validateParams","req","query","nextConfig","isDev","imageData","images","deviceSizes","imageSizes","domains","minimumCacheTTL","formats","remotePatterns","url","w","q","href","errorMessage","Array","isArray","isAbsolute","startsWith","hrefParsed","URL","toString","_error","protocol","hasMatch","width","parseInt","isNaN","sizes","push","isValidSize","quality","headers","isStatic","basePath","getCacheKey","constructor","distDir","cacheDir","get","cacheKey","files","readdir","now","Date","file","maxAgeSt","expireAtSt","split","readFile","Number","value","kind","revalidateAfter","curRevalidate","isStale","_","set","revalidate","Error","err","console","error","statusCode","message","parseCacheControl","str","map","Map","directive","key","trim","toLowerCase","age","endsWith","slice","n","contentType","height","nextConfigOutput","optimizedBuffer","transformer","sequentialRead","rotate","resize","undefined","withoutEnlargement","avif","avifQuality","chromaSubsampling","warn","chalk","yellow","bold","webp","png","jpeg","toBuffer","orientation","getOrientation","operations","Orientation","RIGHT_TOP","type","numRotations","BOTTOM_RIGHT","LEFT_BOTTOM","processBuffer","_req","_res","paramsResult","handleRequest","upstreamBuffer","upstreamType","upstreamRes","fetch","ok","status","Buffer","from","arrayBuffer","mocked","createRequestResponseMocks","method","socket","res","nodeUrl","parse","hasStreamed","concat","buffers","getHeader","cacheControl","dangerouslyAllowSVG","vector","animate","isAnimated","getExtension","output","getMetadata","meta","opts","blurWidth","blurHeight","blurDataURL","unescape","getImageBlurSvg","getFileNameWithExtension","urlWithoutQueryParams","fileNameWithExtension","pop","fileName","setResponseHeaders","xCache","imagesConfig","setHeader","sendEtagResponse","finished","contentDisposition","contentDispositionType","contentSecurityPolicy","getContentType","result","byteLength","end","metadata","decodeBuffer","imageSizeOf","promise","Promise","resolve","reject"],"mappings":"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"}